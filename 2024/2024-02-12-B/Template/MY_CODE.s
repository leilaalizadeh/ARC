ROW			RN 0
COL			RN 1
MAZE		RN 2
VISITED		RN 3
CNT			RN 4
CURRENT		RN 5
TMP			RN 6
INDEX		RN 7
ALL			RN 8
SPACE_INDEX RN 9
						
						
			AREA MY_CODE, CODE, READONLY

exploreMaze	PROC
			EXPORT exploreMaze
			PUSH{R4-R8,R10-R11,LR}
			
			LDR SPACE_INDEX,=0
			MUL ALL,ROW,COL
			ADD INDEX,COL,#1
			MOV CNT,INDEX
FOR			
			CMP ALL,CNT
			BEQ FINISH
			
			
			
            LDRB CURRENT,[MAZE,CNT]	
			LDR TMP,='V'
            STRB TMP,[MAZE,CNT]	
			
			SUB INDEX,ALL,COL
			SUB INDEX,INDEX,#2
			CMP INDEX,CNT
			BEQ FINAL
			
			
			CMP SPACE_INDEX,#0
			IT EQ
            STRBEQ CNT,[VISITED,SPACE_INDEX]
            ;ADDEQ SPACE_INDEX,#1			
RIGHT				
			ADD INDEX,CNT,#1  ;RIGHT
			LDRB TMP,[MAZE,INDEX]
			
			CMP TMP,#'X'
			BEQ LEFT
			
			CMP TMP,#'V'
			BEQ LEFT
			
			CMP TMP,#' '
			BEQ NEXT
			
LEFT
			SUB INDEX,CNT,#1  ;LEFT
			LDRB TMP,[MAZE,INDEX]
			
			CMP TMP,#'X'
			BEQ TOP
			
			CMP TMP,#'V'
			BEQ TOP
			
			CMP TMP,#' '
			BEQ NEXT
			
TOP
			SUB INDEX,CNT,COL  ;TOP
			LDRB TMP,[MAZE,INDEX]
			
			CMP TMP,#'X'
			BEQ BOTTOM
			
			CMP TMP,#'V'
			BEQ BOTTOM
			
			CMP TMP,#' '
			BEQ NEXT

BOTTOM
			ADD INDEX,CNT,COL  ;BOTTOM
			LDRB TMP,[MAZE,INDEX]
			
			CMP TMP,#'X'
			BEQ NOTFOUND
			
			CMP TMP,#'V'
			BEQ NOTFOUND
			
			CMP TMP,#' '
			BEQ NEXT
			
NEXT
			ADD SPACE_INDEX,#1
			STRB INDEX,[VISITED,SPACE_INDEX]
			
			MOV CNT,INDEX
			B FOR
			
NOTFOUND
			LDR TMP,=0
			;SUB SPACE_INDEX,#1
			STRB TMP,[VISITED,SPACE_INDEX]
			SUB SPACE_INDEX,#1
			LDRB CNT,[VISITED,SPACE_INDEX]
			CMP SPACE_INDEX,#0
			BLO NOMOVE
			B FOR

FINAL
			LDR R0,=1
			B FINISH
NOMOVE
			LDR R0,=0
			B FINISH
FINISH
			
			POP{R4-R8,R10-R11,PC}
			ENDP
			ENDP